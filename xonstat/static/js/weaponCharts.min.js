var weaponColors={arc:"#b8e9ff",laser:"#ff5933",blaster:"#ff5933",shotgun:"#1f77b4",uzi:"#b9e659",machinegun:"#b9e659",grenadelauncher:"#ff2600",mortar:"#ff2600",minelayer:"#bfbf00",electro:"#597fff",crylink:"#d940ff",nex:"#00e6ff",vortex:"#00e6ff",hagar:"#d98059",rocketlauncher:"#ffbf33",devastator:"#ffbf33",porto:"#7fff7f",minstanex:"#d62728",vaporizer:"#d62728",hook:"#a5ffd8",hlac:"#ffa533",seeker:"#ff5959",rifle:"#9467bd",tuba:"#d87f3f",fireball:"#33ff33"};var flatten=function(a){flattened={};a.games.forEach(function(c,b){flattened[c]={}});a.weapon_stats.forEach(function(c,b){flattened[c.game_id][c.weapon_cd]=c});return flattened};function accuracyValue(b,c){if(b[c]==undefined){return null}var a=b[c];var d=a.fired>0?Math.round((a.hit/a.fired)*100):0;return d}function accuracyTooltip(b,d,a){if(d==null){return null}var c=b+": "+d.toString()+"%";if(a[b]!=undefined){return c+" ("+a[b].toString()+"% average)"}return c}function drawAccuracyChart(j){var t=new google.visualization.DataTable();t.addColumn("string","X");t.addColumn("number","Shotgun");t.addColumn({type:"string",role:"tooltip"});t.addColumn("number","MG");t.addColumn({type:"string",role:"tooltip"});t.addColumn("number","Vortex");t.addColumn({type:"string",role:"tooltip"});t.addColumn("number","Vaporizer");t.addColumn({type:"string",role:"tooltip"});t.addColumn("number","Rifle");t.addColumn({type:"string",role:"tooltip"});t.addColumn("number","Arc");t.addColumn({type:"string",role:"tooltip"});var k=flatten(j);for(i in j.games){var h=j.games[i];var r=accuracyValue(k[h],"shotgun");var q=accuracyTooltip("shotgun",r,j.averages);var p=accuracyValue(k[h],"machinegun");var b=accuracyTooltip("machinegun",p,j.averages);var s=accuracyValue(k[h],"vortex");var f=accuracyTooltip("vortex",s,j.averages);var n=accuracyValue(k[h],"vaporizer");var o=accuracyTooltip("vaporizer",n,j.averages);var a=accuracyValue(k[h],"rifle");var l=accuracyTooltip("rifle",a,j.averages);var d=accuracyValue(k[h],"arc");var e=accuracyTooltip("arc",d,j.averages);t.addRow([h.toString(),r,q,p,b,s,f,n,o,a,l,d,e])}var c={backgroundColor:{fill:"transparent"},lineWidth:2,legend:{textStyle:{color:"#666"}},hAxis:{title:"Games",textPosition:"none",titleTextStyle:{color:"#666"}},vAxis:{title:"Percentage",titleTextStyle:{color:"#666"},minValue:0,maxValue:100,baselineColor:"#333",gridlineColor:"#333",ticks:[20,40,60,80,100]},series:{0:{color:weaponColors.shotgun},1:{color:weaponColors.machinegun},2:{color:weaponColors.vortex},3:{color:weaponColors.vaporizer},4:{color:weaponColors.rifle},5:{color:weaponColors.arc}}};var g=new google.visualization.LineChart(document.getElementById("accuracyChart"));var m=function(w){var v=g.getSelection()[0];if(v!=null&&v.row!=null){var u=t.getFormattedValue(v.row,0);window.location.href="http://stats.xonotic.org/game/"+u.toString()}};google.visualization.events.addListener(g,"select",m);g.draw(t,c)}function damageValue(a,b){if(a[b]==undefined){return null}return a[b].actual}function damageTooltip(b,a){if(a==null){return null}return b+": "+a.toString()+" HP damage"}function drawDamageChart(s){var D=new google.visualization.DataTable();D.addColumn("string","X");D.addColumn("number","Shotgun");D.addColumn({type:"string",role:"tooltip"});D.addColumn("number","Machine Gun");D.addColumn({type:"string",role:"tooltip"});D.addColumn("number","Vortex");D.addColumn({type:"string",role:"tooltip"});D.addColumn("number","Rifle");D.addColumn({type:"string",role:"tooltip"});D.addColumn("number","Mortar");D.addColumn({type:"string",role:"tooltip"});D.addColumn("number","Electro");D.addColumn({type:"string",role:"tooltip"});D.addColumn("number","Crylink");D.addColumn({type:"string",role:"tooltip"});D.addColumn("number","Hagar");D.addColumn({type:"string",role:"tooltip"});D.addColumn("number","Devastator");D.addColumn({type:"string",role:"tooltip"});D.addColumn("number","Arc");D.addColumn({type:"string",role:"tooltip"});var u=flatten(s);for(i in s.games){var r=s.games[i];var B=damageValue(u[r],"shotgun");var A=damageTooltip("shotgun",B);var z=damageValue(u[r],"machinegun");var b=damageTooltip("machinegun",z);var C=damageValue(u[r],"vortex");var o=damageTooltip("vortex",C);var w=damageValue(u[r],"vaporizer");var y=damageTooltip("vaporizer",w);var a=damageValue(u[r],"rifle");var v=damageTooltip("rifle",a);var q=damageValue(u[r],"mortar");var t=damageTooltip("mortar",q);var j=damageValue(u[r],"electro");var h=damageTooltip("electro",j);var c=damageValue(u[r],"crylink");var d=damageTooltip("crylink",c);var f=damageValue(u[r],"hagar");var l=damageTooltip("hagar",f);var m=damageValue(u[r],"devastator");var n=damageTooltip("devastator",m);var g=damageValue(u[r],"arc");var k=damageTooltip("arc",g);D.addRow([r.toString(),B,A,z,b,C,o,a,v,q,t,j,h,c,d,f,l,m,n,g,k])}var e={backgroundColor:{fill:"transparent"},legend:{position:"top",maxLines:3,textStyle:{color:"#666"}},vAxis:{title:"HP Damage",titleTextStyle:{color:"#666"},baselineColor:"#333",gridlineColor:"#333",},hAxis:{title:"Games",textPosition:"none",titleTextStyle:{color:"#666"},},isStacked:true,series:{0:{color:weaponColors.shotgun},1:{color:weaponColors.machinegun},2:{color:weaponColors.vortex},3:{color:weaponColors.rifle},4:{color:weaponColors.mortar},5:{color:weaponColors.electro},6:{color:weaponColors.crylink},7:{color:weaponColors.hagar},8:{color:weaponColors.devastator},9:{color:weaponColors.arc}}};var p=new google.visualization.ColumnChart(document.getElementById("damageChart"));var x=function(G){var F=p.getSelection()[0];if(F!=null&&F.row!=null){var E=D.getFormattedValue(F.row,0);window.location.href="http://stats.xonotic.org/game/"+E.toString()}};google.visualization.events.addListener(p,"select",x);p.draw(D,e)};